<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculates rarefacted space overlaps — rarefact_space_similarity • PhenotypeSpace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculates rarefacted space overlaps — rarefact_space_similarity"><meta name="description" content="rarefact_space_similarity"><meta property="og:description" content="rarefact_space_similarity"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhenotypeSpace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maRce10/PhenotypeSpace/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculates rarefacted space overlaps</h1>
      <small class="dont-index">Source: <a href="https://github.com/maRce10/PhenotypeSpace/blob/master/R/rarefact_space_similarity.R" class="external-link"><code>R/rarefact_space_similarity.R</code></a></small>
      <div class="d-none name"><code>rarefact_space_similarity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>rarefact_space_similarity</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rarefact_space_similarity</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an object of class "formula" (or one that can be coerced to that class).Must follow the form <code>group ~ dim1 + dim2</code> where dim1 and dim2 are the dimensions of the phenotype space and <code>group</code> refers to the group labels.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing columns for the dimensions of the phenotypic space (numeric) and a categorical or factor column with group labels.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer vector of length 1 indicating the number of samples to be use for rarefaction (i.e. how many samples per group will be gather at each iteration). Default is the minimum sample size across groups.</p></dd>


<dt id="arg-replace">replace<a class="anchor" aria-label="anchor" href="#arg-replace"></a></dt>
<dd><p>Logical argument to control if sampling is done with replacement. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer vector of length 1 setting the seed (see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>). If used results should be the same on different runs, so it makes them replicable.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Numeric vector of length 1. Controls whether parallel computing is applied by specifying the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></dd>


<dt id="arg-pb">pb<a class="anchor" aria-label="anchor" href="#arg-pb"></a></dt>
<dd><p>Logical argument to control if progress bar is shown. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>Integer vector of length 1. Controls how the number of times the rarefaction routine is iterated. Default is 30.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to <code><a href="space_similarity.html">space_similarity</a></code> for customizing similarity measurements.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the mean, minimum, maximum and standard deviation of the similarity metric across iterations for each pair of groups. If the similarity metric is not symmetric (e.g. the proportional area of A that overlaps B is not necessarily the same as the area of B that overlaps A, see <code><a href="space_similarity.html">space_similarity</a></code>) separated columns are supplied for the two comparisons.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function applies a rarefaction sub-sampling procedure for evaluating pairwise space similarity (internally using <code><a href="space_similarity.html">space_similarity</a></code>). The spread and shape of a phenotypic space might change as a function of number of samples. Hence, ideally, spaces should be compared between groups of similar sample sizes. Rarefaction allows to compare groups of unbalanced sample sizes by randomly re-sampling observations using the same number samples across groups iteratively.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Araya-Salas, M, &amp; K. Odom. 2022, PhenotypeSpace: an R package to quantify and compare phenotypic trait spaces R package version 0.1.0.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="space_similarity.html">space_similarity</a></code>, <code><a href="rectangular_to_triangular.html">rectangular_to_triangular</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marcelo Araya-Salas <a href="mailto:marcelo.araya@ucr.ac.cr">marcelo.araya@ucr.ac.cr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_space"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get proportion of space that overlaps (try with more iterations on your own data)</span></span></span>
<span class="r-in"><span><span class="va">prop_overlaps</span> <span class="op">&lt;-</span> <span class="fu">rarefact_space_similarity</span><span class="op">(</span></span></span>
<span class="r-in"><span> formula <span class="op">=</span> <span class="va">group</span> <span class="op">~</span> <span class="va">dimension_1</span> <span class="op">+</span> <span class="va">dimension_2</span>,</span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">example_space</span>,</span></span>
<span class="r-in"><span>method <span class="op">=</span> <span class="st">"proportional.overlap"</span>, </span></span>
<span class="r-in"><span>iterations <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get minimum convex polygon overlap for each group (non-symmetric)</span></span></span>
<span class="r-in"><span><span class="va">mcp_overlaps</span> <span class="op">&lt;-</span> <span class="fu">rarefact_space_similarity</span><span class="op">(</span></span></span>
<span class="r-in"><span> formula <span class="op">=</span> <span class="va">group</span> <span class="op">~</span> <span class="va">dimension_1</span> <span class="op">+</span> <span class="va">dimension_2</span>,</span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">example_space</span>,</span></span>
<span class="r-in"><span> iterations <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert to non-symmetric triangular matrix</span></span></span>
<span class="r-in"><span><span class="fu"><a href="rectangular_to_triangular.html">rectangular_to_triangular</a></span><span class="op">(</span><span class="va">mcp_overlaps</span>, symmetric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rarefaction sample size = 150</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 methods overwritten by 'adehabitatMA':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method                       from</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   print.SpatialPixelsDataFrame sp  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   print.SpatialPixels          sp  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rarefaction sample size = 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           G1        G2        G3        G4        G5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1 0.0000000 0.0000000 0.3155386 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2 0.0000000 0.0000000 0.6089176 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G3 0.1851194 0.5224015 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G4 0.0000000 0.0000000 0.0000000 0.0000000 0.3054063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G5 0.0000000 0.0000000 0.0000000 0.2798535 0.0000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcelo Araya-Salas, Karan Odom.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

